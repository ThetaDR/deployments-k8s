# NSM + linkerd interdomain example over kind clusters



This diagram shows that we have 2 clusters with NSM and also linkerd deployed on the Cluster-2.

In this example, we deploy an http-server (**Workload-2**) on the Cluster-2 and show how it can be reached from Cluster-1.

The client will be `alpine` (**Workload-1**), we will use curl.

## Requires

- [Load balancer](../../loadbalancer)
- [Interdomain DNS](../../dns)
- [Interdomain spire](../../spire)
- [Interdomain nsm](../../nsm)

Or you can run [interdomain script](../../../interdomain.sh)

## Run

Install linkerd for second cluster:
```bash
linkerd --kubeconfig=$KUBECONFIG2 check --pre
linkerd --kubeconfig=$KUBECONFIG2 install --crds | kubectl --kubeconfig=$KUBECONFIG2 apply -f -
linkerd --kubeconfig=$KUBECONFIG2 install > linkerd.yaml
```

Replace linkerd image just to get additional info in linkerd proxy containers
```
proxy:
  accessLog: ""
  await: true
  capabilities: null
  defaultInboundPolicy: all-unauthenticated
  enableExternalProfiles: false
  image:
    name: thetadr/linkerd-proxy
    pullPolicy: ""
    version: logs-linux-2-lldb
    logs-linux-debug 
    logs-linux-debian-sudo
    
    1647: image: thetadr/controller-linkerd:privileged
```

$ k2 exec -it -n ns-nsm-linkerd       proxy-alpine-86fc94c47-4cfcm -c linkerd-proxy -- whereis lldb-server
lldb-server: /usr/bin/lldb-server

```bash
kubectl --kubeconfig=$KUBECONFIG2 apply -f linkerd.yaml
linkerd --kubeconfig=$KUBECONFIG2 check
```

Install networkservice for the second cluster:
```bash
kubectl --kubeconfig=$KUBECONFIG2 create ns ns-nsm-linkerd
kubectl --kubeconfig=$KUBECONFIG2 apply -f ./networkservice.yaml
```

Start `alpine` with networkservicemesh client on the first cluster:

```bash
kubectl --kubeconfig=$KUBECONFIG1 apply -f ./greeting/client.yaml
```

Start `auto-scale` networkservicemesh endpoint:
```bash
kubectl --kubeconfig=$KUBECONFIG2 apply -k ./nse-auto-scale
```

Install http-server for the second cluster:
```bash
kubectl --kubeconfig=$KUBECONFIG2 apply -f ./greeting/server.yaml
kubectl --kubeconfig=$KUBECONFIG2 get deploy greeting -o yaml | linkerd --kubeconfig=$KUBECONFIG2 inject - | kubectl --kubeconfig=$KUBECONFIG2 apply -f -
```


Wait for the `alpine` client to be ready:
```bash
kubectl --kubeconfig=$KUBECONFIG1 wait --timeout=2m --for=condition=ready pod -l app=alpine
```

Get curl for nsc:
```bash
kubectl --kubeconfig=$KUBECONFIG1 exec deploy/alpine -c cmd-nsc -- apk add curl
```

Add iptables to nse (copy pod name like proxy-alpine-86fc94c47-kqdtx manually)
```bash
PROXY_NAME=
kubectl --kubeconfig=$KUBECONFIG2 exec $PROXY_NAME -c nse -- apk add iptables
```

Add this iptables to proxy nse container. (1)
Don't forget to get interface for third rule
```
-N NSM_PREROUTE
-A NSM_PREROUTE -j DNAT --to-destination 127.0.0.1
-I PREROUTING 1 -p tcp -i nsm-linker-4d5a -j NSM_PREROUTE
```

Verify connectivity:
```bash
kubectl --kubeconfig=$KUBECONFIG1 exec deploy/alpine -c cmd-nsc -- curl -s greeting.default:9080 | grep -o "hello world from linkerd"
```
**Expected output** is "hello world from linkerd"

-N NSM_OUTPUT
-A NSM_OUTPUT -j DNAT --to-destination 10.244.1.9
-A OUTPUT -p tcp -s 127.0.0.6 -j NSM_OUTPUT
# ^ should be fine
-N NSM_POSTROUTING
-A NSM_POSTROUTING -j SNAT --to-source {{ index .NsmDstIPs 0 }}
-A POSTROUTING -p tcp -o {{ .NsmInterfaceName }} -j NSM_POSTROUTING


- -I PREROUTING 1 -p tcp -i nsm-linker-e5df -j DNAT --to-destination 127.0.0.1
- -N NSM_OUTPUT
- -A NSM_OUTPUT -j DNAT --to-destination {{ index .NsmSrcIPs 0 }}
- -A OUTPUT -p tcp -d 127.0.0.1 -j NSM_OUTPUT
- -N NSM_POSTROUTING
- -A NSM_POSTROUTING -j SNAT --to-source {{ index .NsmDstIPs 0 }}
- -A POSTROUTING -p tcp -o nsm-linker-d049 -j NSM_POSTROUTING


# Generated by iptables-save v1.8.8 on Fri Dec 16 07:54:35 2022
*filter
:INPUT ACCEPT [4844:259646]
:FORWARD ACCEPT [28:1680]
:OUTPUT ACCEPT [4887:257402]
COMMIT
# Completed on Fri Dec 16 07:54:35 2022
# Generated by iptables-save v1.8.8 on Fri Dec 16 07:54:35 2022
*nat
:PREROUTING ACCEPT [161:7696]
:INPUT ACCEPT [169:8176]
:OUTPUT ACCEPT [9:613]
:POSTROUTING ACCEPT [16:1033]
:PROXY_INIT_OUTPUT - [0:0]
:PROXY_INIT_REDIRECT - [0:0]
-A PREROUTING -d 172.16.1.2/32 -p tcp -m tcp --dport 9080 -j DNAT --to-destination 10.96.197.149:9080
-A PREROUTING -m comment --comment "proxy-init/install-proxy-init-prerouting/1671166536" -j PROXY_INIT_REDIRECT
-A INPUT -p tcp -j LOG
-A OUTPUT -m comment --comment "proxy-init/install-proxy-init-output/1671166536" -j PROXY_INIT_OUTPUT
-A PROXY_INIT_OUTPUT -m owner --uid-owner 2102 -m comment --comment "proxy-init/ignore-proxy-user-id/1671166536" -j RETURN
-A PROXY_INIT_OUTPUT -o lo -m comment --comment "proxy-init/ignore-loopback/1671166536" -j RETURN
-A PROXY_INIT_OUTPUT -p tcp -m multiport --dports 4567,4568 -m comment --comment "proxy-init/ignore-port-4567,4568/1671166536" -j RETURN
-A PROXY_INIT_OUTPUT -p tcp -m comment --comment "proxy-init/redirect-all-outgoing-to-proxy-port/1671166536" -j REDIRECT --to-ports 4140
-A PROXY_INIT_REDIRECT -p tcp -m multiport --dports 4190,4191,4567,4568 -m comment --comment "proxy-init/ignore-port-4190,4191,4567,4568/1671166536" -j RETURN
-A PROXY_INIT_REDIRECT -p tcp -m comment --comment "proxy-init/redirect-all-incoming-to-proxy-port/1671166536" -j REDIRECT --to-ports 4143
COMMIT
# Completed on Fri Dec 16 07:54:35 2022
iptables -t nat -I POSTROUTING -d 10.96.197.149 -j SNAT --to-source 10.244.1.21



# Generated by iptables-save v1.8.8 on Fri Dec 16 09:01:10 2022
*filter
:INPUT ACCEPT [23926:1232484]
:FORWARD ACCEPT [24:1641]
:OUTPUT ACCEPT [23913:1220704]
COMMIT
# Completed on Fri Dec 16 09:01:10 2022
# Generated by iptables-save v1.8.8 on Fri Dec 16 09:01:10 2022
*nat
:PREROUTING ACCEPT [497:23248]
:INPUT ACCEPT [506:23788]
:OUTPUT ACCEPT [10:682]
:POSTROUTING ACCEPT [0:0]
:NSM_POST - [0:0]
:PROXY_INIT_OUTPUT - [0:0]
:PROXY_INIT_REDIRECT - [0:0]
-A PREROUTING -m comment --comment "proxy-init/install-proxy-init-prerouting/1671166536" -j PROXY_INIT_REDIRECT
-A OUTPUT -m comment --comment "proxy-init/install-proxy-init-output/1671166536" -j PROXY_INIT_OUTPUT
-A POSTROUTING -j NSM_POST
-A NSM_POST -d 172.16.1.3/32 -j RETURN
-A NSM_POST -j SNAT --to-source 10.244.1.21
-A PROXY_INIT_OUTPUT -m owner --uid-owner 2102 -m comment --comment "proxy-init/ignore-proxy-user-id/1671166536" -j RETURN
-A PROXY_INIT_OUTPUT -o lo -m comment --comment "proxy-init/ignore-loopback/1671166536" -j RETURN
-A PROXY_INIT_OUTPUT -p tcp -m multiport --dports 4567,4568 -m comment --comment "proxy-init/ignore-port-4567,4568/1671166536" -j RETURN
-A PROXY_INIT_OUTPUT -p tcp -m comment --comment "proxy-init/redirect-all-outgoing-to-proxy-port/1671166536" -j REDIRECT --to-ports 4140
-A PROXY_INIT_REDIRECT -p tcp -m multiport --dports 4190,4191,4567,4568 -m comment --comment "proxy-init/ignore-port-4190,4191,4567,4568/1671166536" -j RETURN
-A PROXY_INIT_REDIRECT -p tcp -m comment --comment "proxy-init/redirect-all-incoming-to-proxy-port/1671166536" -j REDIRECT --to-ports 4143
COMMIT
# Completed on Fri Dec 16 09:01:10 2022





08:55:26.377479 nsm-linker-5ee4 Out IP 172.16.1.2 > 172.16.1.3: ICMP echo reply, id 9537, seq 1, length 24
08:55:26.411336 nsm-linker-5ee4 In  IP 172.16.1.3.45886 > 172.16.1.2.53: Flags [S], seq 2614860635, win 64400, options [mss 1400,sackOK,TS val 3084281357 ecr 0,nop,wscale 7], length 0
08:55:26.411395 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45886: Flags [S.], seq 1283091157, ack 2614860636, win 65236, options [mss 1400,sackOK,TS val 372751250 ecr 3084281357,nop,wscale 7], length 0
08:55:26.411881 nsm-linker-5ee4 In  IP 172.16.1.3.53312 > 172.16.1.2.53: 54188+ A? greeting.default. (34)
08:55:26.412062 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.53312: 54188 ServFail- 0/0/0 (34)
08:55:26.412540 nsm-linker-5ee4 In  IP 172.16.1.3.45886 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281358 ecr 372751250], length 0
08:55:26.412787 nsm-linker-5ee4 In  IP 172.16.1.3.45886 > 172.16.1.2.53: Flags [P.], seq 1:37, ack 1, win 504, options [nop,nop,TS val 3084281359 ecr 372751250], length 36 54188+ A? greeting.default. (34)
08:55:26.412809 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45886: Flags [.], ack 37, win 510, options [nop,nop,TS val 372751251 ecr 3084281359], length 0
08:55:26.413581 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45886: Flags [R.], seq 1, ack 37, win 510, options [nop,nop,TS val 372751252 ecr 3084281359], length 0
08:55:26.415970 nsm-linker-5ee4 In  IP 172.16.1.3.45888 > 172.16.1.2.53: Flags [S], seq 480256775, win 64400, options [mss 1400,sackOK,TS val 3084281362 ecr 0,nop,wscale 7], length 0
08:55:26.416022 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45888: Flags [S.], seq 4000737655, ack 480256776, win 65236, options [mss 1400,sackOK,TS val 372751254 ecr 3084281362,nop,wscale 7], length 0
08:55:26.416323 nsm-linker-5ee4 In  IP 172.16.1.3.35828 > 172.16.1.2.53: 54472+ AAAA? greeting.default. (34)
08:55:26.416568 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.35828: 54472 ServFail- 0/0/0 (34)
08:55:26.416762 nsm-linker-5ee4 In  IP 172.16.1.3.45888 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281363 ecr 372751254], length 0
08:55:26.417833 nsm-linker-5ee4 In  IP 172.16.1.3.45892 > 172.16.1.2.53: Flags [S], seq 3256411803, win 64400, options [mss 1400,sackOK,TS val 3084281364 ecr 0,nop,wscale 7], length 0
08:55:26.417845 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45888: Flags [F.], seq 1, ack 1, win 510, options [nop,nop,TS val 372751256 ecr 3084281363], length 0
08:55:26.417876 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45892: Flags [S.], seq 2309925931, ack 3256411804, win 65236, options [mss 1400,sackOK,TS val 372751256 ecr 3084281364,nop,wscale 7], length 0
08:55:26.418372 nsm-linker-5ee4 In  IP 172.16.1.3.33829 > 172.16.1.2.53: 54188+ A? greeting.default.default.svc.cluster.local. (60)
08:55:26.418491 nsm-linker-5ee4 In  IP 172.16.1.3.45892 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281365 ecr 372751256], length 0
08:55:26.418726 lo    In  IP 10.244.1.21.35830 > 127.0.0.1.4140: Flags [S], seq 3614321609, win 64240, options [mss 1460,sackOK,TS val 3186051501 ecr 0,nop,wscale 7], length 0
08:55:26.418745 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35830: Flags [S.], seq 3470163522, ack 3614321610, win 65483, options [mss 65495,sackOK,TS val 2383005073 ecr 3186051501,nop,wscale 7], length 0
08:55:26.418763 lo    In  IP 10.244.1.21.35830 > 127.0.0.1.4140: Flags [.], ack 3470163523, win 502, options [nop,nop,TS val 3186051501 ecr 2383005073], length 0
08:55:26.418873 lo    In  IP 10.244.1.21.35830 > 127.0.0.1.4140: Flags [P.], seq 0:62, ack 1, win 502, options [nop,nop,TS val 3186051501 ecr 2383005073], length 62
08:55:26.418883 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35830: Flags [.], ack 63, win 512, options [nop,nop,TS val 2383005073 ecr 3186051501], length 0
08:55:26.419116 nsm-linker-5ee4 In  IP 172.16.1.3.45888 > 172.16.1.2.53: Flags [P.], seq 1:37, ack 2, win 504, options [nop,nop,TS val 3084281365 ecr 372751256], length 36 54472+ AAAA? greeting.default. (34)
08:55:26.419174 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45888: Flags [R], seq 4000737657, win 0, length 0
08:55:26.419594 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45892: Flags [F.], seq 1, ack 1, win 510, options [nop,nop,TS val 372751258 ecr 3084281365], length 0
08:55:26.420349 nsm-linker-5ee4 In  IP 172.16.1.3.45892 > 172.16.1.2.53: Flags [.], ack 2, win 504, options [nop,nop,TS val 3084281367 ecr 372751258], length 0
08:55:26.421993 nsm-linker-5ee4 In  IP 172.16.1.3.45902 > 172.16.1.2.53: Flags [S], seq 3522809573, win 64400, options [mss 1400,sackOK,TS val 3084281368 ecr 0,nop,wscale 7], length 0
08:55:26.422071 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45902: Flags [S.], seq 1773475863, ack 3522809574, win 65236, options [mss 1400,sackOK,TS val 372751260 ecr 3084281368,nop,wscale 7], length 0
08:55:26.422081 nsm-linker-5ee4 In  IP 172.16.1.3.49260 > 172.16.1.2.53: 54472+ AAAA? greeting.default.default.svc.cluster.local. (60)
08:55:26.422398 lo    In  IP 10.244.1.21.35838 > 127.0.0.1.4140: Flags [S], seq 2312492274, win 64240, options [mss 1460,sackOK,TS val 3186051505 ecr 0,nop,wscale 7], length 0
08:55:26.422420 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35838: Flags [S.], seq 2598792265, ack 2312492275, win 65483, options [mss 65495,sackOK,TS val 2383005077 ecr 3186051505,nop,wscale 7], length 0
08:55:26.422439 lo    In  IP 10.244.1.21.35838 > 127.0.0.1.4140: Flags [.], ack 2598792266, win 502, options [nop,nop,TS val 3186051505 ecr 2383005077], length 0
08:55:26.422566 lo    In  IP 10.244.1.21.35838 > 127.0.0.1.4140: Flags [P.], seq 0:62, ack 1, win 502, options [nop,nop,TS val 3186051505 ecr 2383005077], length 62
08:55:26.422575 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35838: Flags [.], ack 63, win 512, options [nop,nop,TS val 2383005077 ecr 3186051505], length 0
08:55:26.423053 nsm-linker-5ee4 In  IP 172.16.1.3.45902 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281369 ecr 372751260], length 0
08:55:26.423122 nsm-linker-5ee4 In  IP 172.16.1.3.45902 > 172.16.1.2.53: Flags [P.], seq 1:63, ack 1, win 504, options [nop,nop,TS val 3084281369 ecr 372751260], length 62 54472+ AAAA? greeting.default.default.svc.cluster.local. (60)
08:55:26.423143 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45902: Flags [.], ack 63, win 510, options [nop,nop,TS val 372751262 ecr 3084281369], length 0
08:55:26.423998 eth0  Out IP 10.244.1.21.45990 > 10.244.1.11.8086: Flags [P.], seq 2914387862:2914388029, ack 4075913300, win 501, options [nop,nop,TS val 2474561817 ecr 484563424], length 167
08:55:26.425428 eth0  Out IP 10.244.1.21.53925 > 10.96.0.10.53: 5621+ SRV? linkerd-dst-headless.linkerd.svc.cluster.local. (64)
08:55:26.425893 eth0  In  IP 10.96.0.10.53 > 10.244.1.21.53925: 5621*- 1/0/1 SRV 10-244-1-11.linkerd-dst-headless.linkerd.svc.cluster.local.:8086 0 100 (262)
08:55:26.426003 nsm-linker-5ee4 In  IP 172.16.1.3.45892 > 172.16.1.2.53: Flags [P.], seq 1:63, ack 2, win 504, options [nop,nop,TS val 3084281371 ecr 372751258], length 62 54188+ A? greeting.default.default.svc.cluster.local. (60)
08:55:26.426032 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45892: Flags [R], seq 2309925933, win 0, length 0
08:55:26.426347 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45902: Flags [R.], seq 1, ack 63, win 510, options [nop,nop,TS val 372751265 ecr 3084281369], length 0
08:55:26.426350 eth0  In  IP 10.244.1.11.8086 > 10.244.1.21.45990: Flags [P.], seq 1:259, ack 167, win 501, options [nop,nop,TS val 484633358 ecr 2474561817], length 258
08:55:26.426444 nsm-linker-5ee4 In  IP 172.16.1.3.45892 > 172.16.1.2.53: Flags [F.], seq 63, ack 2, win 504, options [nop,nop,TS val 3084281372 ecr 372751258], length 0
08:55:26.426468 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45892: Flags [R], seq 2309925933, win 0, length 0
08:55:26.432735 eth0  Out IP 10.244.1.21.45990 > 10.244.1.11.8086: Flags [P.], seq 167:357, ack 259, win 501, options [nop,nop,TS val 2474561826 ecr 484633358], length 190
08:55:26.433911 eth0  In  IP 10.244.1.11.8086 > 10.244.1.21.45990: Flags [P.], seq 259:302, ack 357, win 501, options [nop,nop,TS val 484633365 ecr 2474561826], length 43
08:55:26.433958 eth0  In  IP 10.244.1.11.8086 > 10.244.1.21.45990: Flags [P.], seq 302:649, ack 357, win 501, options [nop,nop,TS val 484633365 ecr 2474561826], length 347
08:55:26.434182 eth0  Out IP 10.244.1.21.45990 > 10.244.1.11.8086: Flags [.], ack 649, win 501, options [nop,nop,TS val 2474561828 ecr 484633365], length 0
08:55:26.437222 eth0  Out IP 10.244.1.21.37812 > 10.244.0.4.53: Flags [S], seq 3276152366, win 64240, options [mss 1460,sackOK,TS val 3847823313 ecr 0,nop,wscale 7], length 0
08:55:26.437397 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37812: Flags [S.], seq 2382347727, ack 3276152367, win 65160, options [mss 1460,sackOK,TS val 2649092129 ecr 3847823313,nop,wscale 7], length 0
08:55:26.437417 eth0  Out IP 10.244.1.21.37812 > 10.244.0.4.53: Flags [.], ack 1, win 502, options [nop,nop,TS val 3847823313 ecr 2649092129], length 0
08:55:26.437696 eth0  Out IP 10.244.1.21.50610 > 10.244.0.2.53: Flags [S], seq 2225413138, win 64240, options [mss 1460,sackOK,TS val 1604553658 ecr 0,nop,wscale 7], length 0
08:55:26.437810 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50610: Flags [S.], seq 2088380673, ack 2225413139, win 65160, options [mss 1460,sackOK,TS val 2736739047 ecr 1604553658,nop,wscale 7], length 0
08:55:26.437825 eth0  Out IP 10.244.1.21.50610 > 10.244.0.2.53: Flags [.], ack 1, win 502, options [nop,nop,TS val 1604553658 ecr 2736739047], length 0
08:55:26.438429 eth0  Out IP 10.244.1.21.37812 > 10.244.0.4.53: Flags [P.], seq 1:63, ack 1, win 502, options [nop,nop,TS val 3847823314 ecr 2649092129], length 62 54188 A? greeting.default.default.svc.cluster.local. (60)
08:55:26.438541 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37812: Flags [.], ack 63, win 509, options [nop,nop,TS val 2649092130 ecr 3847823314], length 0
08:55:26.438676 eth0  Out IP 10.244.1.21.50610 > 10.244.0.2.53: Flags [P.], seq 1:63, ack 1, win 502, options [nop,nop,TS val 1604553659 ecr 2736739047], length 62 54472 AAAA? greeting.default.default.svc.cluster.local. (60)
08:55:26.438721 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37812: Flags [P.], seq 1:156, ack 63, win 509, options [nop,nop,TS val 2649092130 ecr 3847823314], length 155 54188 NXDomain*- 0/1/0 (153)
08:55:26.438732 eth0  Out IP 10.244.1.21.37812 > 10.244.0.4.53: Flags [.], ack 156, win 501, options [nop,nop,TS val 3847823314 ecr 2649092130], length 0
08:55:26.438748 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50610: Flags [.], ack 63, win 509, options [nop,nop,TS val 2736739048 ecr 1604553659], length 0
08:55:26.438923 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35830: Flags [P.], seq 1:156, ack 63, win 512, options [nop,nop,TS val 2383005093 ecr 3186051501], length 155 54188 NXDomain*- 0/1/0 (153)
08:55:26.438942 lo    In  IP 10.244.1.21.35830 > 127.0.0.1.4140: Flags [.], ack 156, win 501, options [nop,nop,TS val 3186051521 ecr 2383005093], length 0
08:55:26.439017 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50610: Flags [P.], seq 1:156, ack 63, win 509, options [nop,nop,TS val 2736739048 ecr 1604553659], length 155 54472 NXDomain*- 0/1/0 (153)
08:55:26.439045 eth0  Out IP 10.244.1.21.50610 > 10.244.0.2.53: Flags [.], ack 156, win 501, options [nop,nop,TS val 1604553659 ecr 2736739048], length 0
08:55:26.439198 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35838: Flags [P.], seq 1:156, ack 63, win 512, options [nop,nop,TS val 2383005094 ecr 3186051505], length 155 54472 NXDomain*- 0/1/0 (153)
08:55:26.439215 lo    In  IP 10.244.1.21.35838 > 127.0.0.1.4140: Flags [.], ack 156, win 501, options [nop,nop,TS val 3186051522 ecr 2383005094], length 0
08:55:26.439279 lo    In  IP 10.244.1.21.35830 > 127.0.0.1.4140: Flags [F.], seq 62, ack 156, win 501, options [nop,nop,TS val 3186051522 ecr 2383005093], length 0
08:55:26.439337 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.33829: 54188 NXDomain*- 0/1/0 (153)
08:55:26.439378 eth0  Out IP 10.244.1.21.37812 > 10.244.0.4.53: Flags [F.], seq 63, ack 156, win 501, options [nop,nop,TS val 3847823315 ecr 2649092130], length 0
08:55:26.439384 lo    In  IP 10.244.1.21.35838 > 127.0.0.1.4140: Flags [F.], seq 62, ack 156, win 501, options [nop,nop,TS val 3186051522 ecr 2383005094], length 0
08:55:26.439402 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.49260: 54472 NXDomain*- 0/1/0 (153)
08:55:26.439541 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37812: Flags [F.], seq 156, ack 64, win 509, options [nop,nop,TS val 2649092131 ecr 3847823315], length 0
08:55:26.439549 eth0  Out IP 10.244.1.21.50610 > 10.244.0.2.53: Flags [F.], seq 63, ack 156, win 501, options [nop,nop,TS val 1604553660 ecr 2736739048], length 0
08:55:26.439555 eth0  Out IP 10.244.1.21.37812 > 10.244.0.4.53: Flags [.], ack 157, win 501, options [nop,nop,TS val 3847823315 ecr 2649092131], length 0
08:55:26.439681 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50610: Flags [F.], seq 156, ack 64, win 509, options [nop,nop,TS val 2736739049 ecr 1604553660], length 0
08:55:26.439691 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35830: Flags [F.], seq 156, ack 64, win 512, options [nop,nop,TS val 2383005094 ecr 3186051522], length 0
08:55:26.439699 eth0  Out IP 10.244.1.21.50610 > 10.244.0.2.53: Flags [.], ack 157, win 501, options [nop,nop,TS val 1604553660 ecr 2736739049], length 0
08:55:26.439708 lo    In  IP 10.244.1.21.35830 > 127.0.0.1.4140: Flags [.], ack 157, win 501, options [nop,nop,TS val 3186051522 ecr 2383005094], length 0
08:55:26.440651 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35838: Flags [F.], seq 156, ack 64, win 512, options [nop,nop,TS val 2383005095 ecr 3186051522], length 0
08:55:26.440674 lo    In  IP 10.244.1.21.35838 > 127.0.0.1.4140: Flags [.], ack 157, win 501, options [nop,nop,TS val 3186051523 ecr 2383005095], length 0
08:55:26.446443 nsm-linker-5ee4 In  IP 172.16.1.3.59919 > 172.16.1.2.53: 54472+ AAAA? greeting.default.svc.cluster.local. (52)
08:55:26.446508 nsm-linker-5ee4 In  IP 172.16.1.3.45914 > 172.16.1.2.53: Flags [S], seq 614876803, win 64400, options [mss 1400,sackOK,TS val 3084281392 ecr 0,nop,wscale 7], length 0
08:55:26.446553 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45914: Flags [S.], seq 690604192, ack 614876804, win 65236, options [mss 1400,sackOK,TS val 372751285 ecr 3084281392,nop,wscale 7], length 0
08:55:26.446775 lo    In  IP 10.244.1.21.35840 > 127.0.0.1.4140: Flags [S], seq 4187883890, win 64240, options [mss 1460,sackOK,TS val 3186051529 ecr 0,nop,wscale 7], length 0
08:55:26.446796 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35840: Flags [S.], seq 2803078448, ack 4187883891, win 65483, options [mss 65495,sackOK,TS val 2383005101 ecr 3186051529,nop,wscale 7], length 0
08:55:26.446817 lo    In  IP 10.244.1.21.35840 > 127.0.0.1.4140: Flags [.], ack 2803078449, win 502, options [nop,nop,TS val 3186051529 ecr 2383005101], length 0
08:55:26.447127 lo    In  IP 10.244.1.21.35840 > 127.0.0.1.4140: Flags [P.], seq 0:54, ack 1, win 502, options [nop,nop,TS val 3186051529 ecr 2383005101], length 54
08:55:26.447149 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35840: Flags [.], ack 55, win 512, options [nop,nop,TS val 2383005102 ecr 3186051529], length 0
08:55:26.449176 eth0  Out IP 10.244.1.21.37822 > 10.244.0.4.53: Flags [S], seq 2631649334, win 64240, options [mss 1460,sackOK,TS val 3847823325 ecr 0,nop,wscale 7], length 0
08:55:26.449318 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37822: Flags [S.], seq 535322036, ack 2631649335, win 65160, options [mss 1460,sackOK,TS val 2649092141 ecr 3847823325,nop,wscale 7], length 0
08:55:26.449338 eth0  Out IP 10.244.1.21.37822 > 10.244.0.4.53: Flags [.], ack 1, win 502, options [nop,nop,TS val 3847823325 ecr 2649092141], length 0
08:55:26.449902 eth0  Out IP 10.244.1.21.37822 > 10.244.0.4.53: Flags [P.], seq 1:55, ack 1, win 502, options [nop,nop,TS val 3847823325 ecr 2649092141], length 54 54472 AAAA? greeting.default.svc.cluster.local. (52)
08:55:26.450007 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37822: Flags [.], ack 55, win 509, options [nop,nop,TS val 2649092141 ecr 3847823325], length 0
08:55:26.450203 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37822: Flags [P.], seq 1:148, ack 55, win 509, options [nop,nop,TS val 2649092142 ecr 3847823325], length 147 54472*- 0/1/0 (145)
08:55:26.450226 eth0  Out IP 10.244.1.21.37822 > 10.244.0.4.53: Flags [.], ack 148, win 501, options [nop,nop,TS val 3847823326 ecr 2649092142], length 0
08:55:26.452606 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35840: Flags [P.], seq 1:148, ack 55, win 512, options [nop,nop,TS val 2383005107 ecr 3186051529], length 147 54472*- 0/1/0 (145)
08:55:26.452625 lo    In  IP 10.244.1.21.35840 > 127.0.0.1.4140: Flags [.], ack 148, win 501, options [nop,nop,TS val 3186051535 ecr 2383005107], length 0
08:55:26.452861 lo    In  IP 10.244.1.21.35840 > 127.0.0.1.4140: Flags [F.], seq 54, ack 148, win 501, options [nop,nop,TS val 3186051535 ecr 2383005107], length 0
08:55:26.452933 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.59919: 54472*- 0/1/0 (145)
08:55:26.452992 nsm-linker-5ee4 In  IP 172.16.1.3.45914 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281393 ecr 372751285], length 0
08:55:26.453062 eth0  Out IP 10.244.1.21.37822 > 10.244.0.4.53: Flags [F.], seq 55, ack 148, win 501, options [nop,nop,TS val 3847823328 ecr 2649092142], length 0
08:55:26.453265 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37822: Flags [F.], seq 148, ack 56, win 509, options [nop,nop,TS val 2649092145 ecr 3847823328], length 0
08:55:26.453271 nsm-linker-5ee4 In  IP 172.16.1.3.45930 > 172.16.1.2.53: Flags [S], seq 174043002, win 64400, options [mss 1400,sackOK,TS val 3084281394 ecr 0,nop,wscale 7], length 0
08:55:26.453283 eth0  Out IP 10.244.1.21.37822 > 10.244.0.4.53: Flags [.], ack 149, win 501, options [nop,nop,TS val 3847823329 ecr 2649092145], length 0
08:55:26.453302 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45930: Flags [S.], seq 2153961760, ack 174043003, win 65236, options [mss 1400,sackOK,TS val 372751292 ecr 3084281394,nop,wscale 7], length 0
08:55:26.453419 nsm-linker-5ee4 In  IP 172.16.1.3.45914 > 172.16.1.2.53: Flags [P.], seq 1:55, ack 1, win 504, options [nop,nop,TS val 3084281394 ecr 372751285], length 54 54472+ AAAA? greeting.default.svc.cluster.local. (52)
08:55:26.453435 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45914: Flags [.], ack 55, win 510, options [nop,nop,TS val 372751292 ecr 3084281394], length 0
08:55:26.453812 nsm-linker-5ee4 In  IP 172.16.1.3.45930 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281400 ecr 372751292], length 0
08:55:26.454119 nsm-linker-5ee4 In  IP 172.16.1.3.45930 > 172.16.1.2.53: Flags [P.], seq 1:55, ack 1, win 504, options [nop,nop,TS val 3084281400 ecr 372751292], length 54 54188+ A? greeting.default.svc.cluster.local. (52)
08:55:26.454145 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45930: Flags [.], ack 55, win 510, options [nop,nop,TS val 372751293 ecr 3084281400], length 0
08:55:26.454242 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45914: Flags [R.], seq 1, ack 55, win 510, options [nop,nop,TS val 372751293 ecr 3084281394], length 0
08:55:26.454587 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35840: Flags [F.], seq 148, ack 56, win 512, options [nop,nop,TS val 2383005109 ecr 3186051535], length 0
08:55:26.454615 lo    In  IP 10.244.1.21.35840 > 127.0.0.1.4140: Flags [.], ack 149, win 501, options [nop,nop,TS val 3186051537 ecr 2383005109], length 0
08:55:26.454657 nsm-linker-5ee4 In  IP 172.16.1.3.35136 > 172.16.1.2.53: 54188+ A? greeting.default.svc.cluster.local. (52)
08:55:26.454935 lo    In  IP 10.244.1.21.35856 > 127.0.0.1.4140: Flags [S], seq 254036642, win 64240, options [mss 1460,sackOK,TS val 3186051537 ecr 0,nop,wscale 7], length 0
08:55:26.454959 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35856: Flags [S.], seq 2821099629, ack 254036643, win 65483, options [mss 65495,sackOK,TS val 2383005109 ecr 3186051537,nop,wscale 7], length 0
08:55:26.454977 lo    In  IP 10.244.1.21.35856 > 127.0.0.1.4140: Flags [.], ack 2821099630, win 502, options [nop,nop,TS val 3186051537 ecr 2383005109], length 0
08:55:26.455111 lo    In  IP 10.244.1.21.35856 > 127.0.0.1.4140: Flags [P.], seq 0:54, ack 1, win 502, options [nop,nop,TS val 3186051537 ecr 2383005109], length 54
08:55:26.455122 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35856: Flags [.], ack 55, win 512, options [nop,nop,TS val 2383005110 ecr 3186051537], length 0
08:55:26.455711 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45930: Flags [R.], seq 1, ack 55, win 510, options [nop,nop,TS val 372751294 ecr 3084281400], length 0
08:55:26.457340 nsm-linker-5ee4 In  IP 172.16.1.3.43389 > 172.16.1.2.53: 54472+ AAAA? greeting.default.cluster.local. (48)
08:55:26.457677 lo    In  IP 10.244.1.21.35872 > 127.0.0.1.4140: Flags [S], seq 526468306, win 64240, options [mss 1460,sackOK,TS val 3186051540 ecr 0,nop,wscale 7], length 0
08:55:26.457704 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35872: Flags [S.], seq 3015441461, ack 526468307, win 65483, options [mss 65495,sackOK,TS val 2383005112 ecr 3186051540,nop,wscale 7], length 0
08:55:26.457724 lo    In  IP 10.244.1.21.35872 > 127.0.0.1.4140: Flags [.], ack 3015441462, win 502, options [nop,nop,TS val 3186051540 ecr 2383005112], length 0
08:55:26.457851 eth0  Out IP 10.244.1.21.50624 > 10.244.0.2.53: Flags [S], seq 1868471261, win 64240, options [mss 1460,sackOK,TS val 1604553678 ecr 0,nop,wscale 7], length 0
08:55:26.457863 lo    In  IP 10.244.1.21.35872 > 127.0.0.1.4140: Flags [P.], seq 0:50, ack 1, win 502, options [nop,nop,TS val 3186051540 ecr 2383005112], length 50
08:55:26.457873 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35872: Flags [.], ack 51, win 512, options [nop,nop,TS val 2383005112 ecr 3186051540], length 0
08:55:26.458018 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50624: Flags [S.], seq 3095799551, ack 1868471262, win 65160, options [mss 1460,sackOK,TS val 2736739067 ecr 1604553678,nop,wscale 7], length 0
08:55:26.458037 eth0  Out IP 10.244.1.21.50624 > 10.244.0.2.53: Flags [.], ack 1, win 502, options [nop,nop,TS val 1604553678 ecr 2736739067], length 0
08:55:26.458369 nsm-linker-5ee4 In  IP 172.16.1.3.45944 > 172.16.1.2.53: Flags [S], seq 2692639939, win 64400, options [mss 1400,sackOK,TS val 3084281405 ecr 0,nop,wscale 7], length 0
08:55:26.458421 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45944: Flags [S.], seq 3851993222, ack 2692639940, win 65236, options [mss 1400,sackOK,TS val 372751297 ecr 3084281405,nop,wscale 7], length 0
08:55:26.459342 nsm-linker-5ee4 In  IP 172.16.1.3.45944 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281405 ecr 372751297], length 0
08:55:26.459891 nsm-linker-5ee4 In  IP 172.16.1.3.45944 > 172.16.1.2.53: Flags [P.], seq 1:51, ack 1, win 504, options [nop,nop,TS val 3084281406 ecr 372751297], length 50 54472+ AAAA? greeting.default.cluster.local. (48)
08:55:26.459941 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45944: Flags [.], ack 51, win 510, options [nop,nop,TS val 372751298 ecr 3084281406], length 0
08:55:26.460375 eth0  Out IP 10.244.1.21.50624 > 10.244.0.2.53: Flags [P.], seq 1:55, ack 1, win 502, options [nop,nop,TS val 1604553681 ecr 2736739067], length 54 54188 A? greeting.default.svc.cluster.local. (52)
08:55:26.460495 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50624: Flags [.], ack 55, win 509, options [nop,nop,TS val 2736739070 ecr 1604553681], length 0
08:55:26.460707 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50624: Flags [P.], seq 1:105, ack 55, win 509, options [nop,nop,TS val 2736739070 ecr 1604553681], length 104 54188*- 1/0/0 A 10.96.197.149 (102)
08:55:26.460722 eth0  Out IP 10.244.1.21.50624 > 10.244.0.2.53: Flags [.], ack 105, win 502, options [nop,nop,TS val 1604553681 ecr 2736739070], length 0
08:55:26.462016 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45944: Flags [R.], seq 1, ack 51, win 510, options [nop,nop,TS val 372751300 ecr 3084281406], length 0
08:55:26.462335 eth0  Out IP 10.244.1.21.37826 > 10.244.0.4.53: Flags [S], seq 200825231, win 64240, options [mss 1460,sackOK,TS val 3847823338 ecr 0,nop,wscale 7], length 0
08:55:26.462527 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37826: Flags [S.], seq 302739475, ack 200825232, win 65160, options [mss 1460,sackOK,TS val 2649092154 ecr 3847823338,nop,wscale 7], length 0
08:55:26.462563 eth0  Out IP 10.244.1.21.37826 > 10.244.0.4.53: Flags [.], ack 1, win 502, options [nop,nop,TS val 3847823338 ecr 2649092154], length 0
08:55:26.462939 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35856: Flags [P.], seq 1:105, ack 55, win 512, options [nop,nop,TS val 2383005117 ecr 3186051537], length 104 54188*- 1/0/0 A 10.96.197.149 (102)
08:55:26.462956 lo    In  IP 10.244.1.21.35856 > 127.0.0.1.4140: Flags [.], ack 105, win 502, options [nop,nop,TS val 3186051545 ecr 2383005117], length 0
08:55:26.463073 lo    In  IP 10.244.1.21.35856 > 127.0.0.1.4140: Flags [F.], seq 54, ack 105, win 502, options [nop,nop,TS val 3186051545 ecr 2383005117], length 0
08:55:26.463136 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.35136: 54188*- 1/0/0 A 172.16.1.2 (102)
08:55:26.463323 eth0  Out IP 10.244.1.21.37826 > 10.244.0.4.53: Flags [P.], seq 1:51, ack 1, win 502, options [nop,nop,TS val 3847823339 ecr 2649092154], length 50 54472 AAAA? greeting.default.cluster.local. (48)
08:55:26.463519 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37826: Flags [.], ack 51, win 509, options [nop,nop,TS val 2649092155 ecr 3847823339], length 0
08:55:26.463699 eth0  Out IP 10.244.1.21.50624 > 10.244.0.2.53: Flags [F.], seq 55, ack 105, win 502, options [nop,nop,TS val 1604553684 ecr 2736739070], length 0
08:55:26.463818 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37826: Flags [P.], seq 1:144, ack 51, win 509, options [nop,nop,TS val 2649092155 ecr 3847823339], length 143 54472 NXDomain*- 0/1/0 (141)
08:55:26.463843 eth0  Out IP 10.244.1.21.37826 > 10.244.0.4.53: Flags [.], ack 144, win 501, options [nop,nop,TS val 3847823339 ecr 2649092155], length 0
08:55:26.463867 eth0  In  IP 10.244.0.2.53 > 10.244.1.21.50624: Flags [F.], seq 105, ack 56, win 509, options [nop,nop,TS val 2736739073 ecr 1604553684], length 0
08:55:26.463883 eth0  Out IP 10.244.1.21.50624 > 10.244.0.2.53: Flags [.], ack 106, win 502, options [nop,nop,TS val 1604553684 ecr 2736739073], length 0
08:55:26.463959 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35872: Flags [P.], seq 1:144, ack 51, win 512, options [nop,nop,TS val 2383005118 ecr 3186051540], length 143 54472 NXDomain*- 0/1/0 (141)
08:55:26.463975 lo    In  IP 10.244.1.21.35872 > 127.0.0.1.4140: Flags [.], ack 144, win 501, options [nop,nop,TS val 3186051546 ecr 2383005118], length 0
08:55:26.464075 lo    In  IP 10.244.1.21.35872 > 127.0.0.1.4140: Flags [F.], seq 50, ack 144, win 501, options [nop,nop,TS val 3186051546 ecr 2383005118], length 0
08:55:26.464078 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35856: Flags [F.], seq 105, ack 56, win 512, options [nop,nop,TS val 2383005118 ecr 3186051545], length 0
08:55:26.464089 lo    In  IP 10.244.1.21.35856 > 127.0.0.1.4140: Flags [.], ack 106, win 502, options [nop,nop,TS val 3186051546 ecr 2383005118], length 0
08:55:26.464182 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.43389: 54472 NXDomain*- 0/1/0 (141)
08:55:26.464903 eth0  Out IP 10.244.1.21.37826 > 10.244.0.4.53: Flags [F.], seq 51, ack 144, win 501, options [nop,nop,TS val 3847823340 ecr 2649092155], length 0
08:55:26.465188 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37826: Flags [F.], seq 144, ack 52, win 509, options [nop,nop,TS val 2649092156 ecr 3847823340], length 0
08:55:26.465220 eth0  Out IP 10.244.1.21.37826 > 10.244.0.4.53: Flags [.], ack 145, win 501, options [nop,nop,TS val 3847823341 ecr 2649092156], length 0
08:55:26.465321 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35872: Flags [F.], seq 144, ack 52, win 512, options [nop,nop,TS val 2383005120 ecr 3186051546], length 0
08:55:26.465341 lo    In  IP 10.244.1.21.35872 > 127.0.0.1.4140: Flags [.], ack 145, win 501, options [nop,nop,TS val 3186051548 ecr 2383005120], length 0
08:55:26.467096 nsm-linker-5ee4 In  IP 172.16.1.3.45795 > 172.16.1.2.53: 54188+ A? greeting.default.cluster.local. (48)
08:55:26.467345 nsm-linker-5ee4 In  IP 172.16.1.3.45956 > 172.16.1.2.53: Flags [S], seq 1003300030, win 64400, options [mss 1400,sackOK,TS val 3084281413 ecr 0,nop,wscale 7], length 0
08:55:26.467380 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45956: Flags [S.], seq 348520216, ack 1003300031, win 65236, options [mss 1400,sackOK,TS val 372751306 ecr 3084281413,nop,wscale 7], length 0
08:55:26.467393 lo    In  IP 10.244.1.21.35876 > 127.0.0.1.4140: Flags [S], seq 1519401382, win 64240, options [mss 1460,sackOK,TS val 3186051550 ecr 0,nop,wscale 7], length 0
08:55:26.467416 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35876: Flags [S.], seq 3601771253, ack 1519401383, win 65483, options [mss 65495,sackOK,TS val 2383005122 ecr 3186051550,nop,wscale 7], length 0
08:55:26.467434 lo    In  IP 10.244.1.21.35876 > 127.0.0.1.4140: Flags [.], ack 3601771254, win 502, options [nop,nop,TS val 3186051550 ecr 2383005122], length 0
08:55:26.467563 lo    In  IP 10.244.1.21.35876 > 127.0.0.1.4140: Flags [P.], seq 0:50, ack 1, win 502, options [nop,nop,TS val 3186051550 ecr 2383005122], length 50
08:55:26.467573 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35876: Flags [.], ack 51, win 512, options [nop,nop,TS val 2383005122 ecr 3186051550], length 0
08:55:26.467837 nsm-linker-5ee4 In  IP 172.16.1.3.45956 > 172.16.1.2.53: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281414 ecr 372751306], length 0
08:55:26.468197 nsm-linker-5ee4 In  IP 172.16.1.3.45956 > 172.16.1.2.53: Flags [P.], seq 1:51, ack 1, win 504, options [nop,nop,TS val 3084281414 ecr 372751306], length 50 54188+ A? greeting.default.cluster.local. (48)
08:55:26.468225 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45956: Flags [.], ack 51, win 510, options [nop,nop,TS val 372751307 ecr 3084281414], length 0
08:55:26.470613 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45956: Flags [R.], seq 1, ack 51, win 510, options [nop,nop,TS val 372751309 ecr 3084281414], length 0
08:55:26.470943 eth0  Out IP 10.244.1.21.37842 > 10.244.0.4.53: Flags [S], seq 4178896089, win 64240, options [mss 1460,sackOK,TS val 3847823346 ecr 0,nop,wscale 7], length 0
08:55:26.471114 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37842: Flags [S.], seq 1239208809, ack 4178896090, win 65160, options [mss 1460,sackOK,TS val 2649092162 ecr 3847823346,nop,wscale 7], length 0
08:55:26.471140 eth0  Out IP 10.244.1.21.37842 > 10.244.0.4.53: Flags [.], ack 1, win 502, options [nop,nop,TS val 3847823347 ecr 2649092162], length 0
08:55:26.471773 eth0  Out IP 10.244.1.21.37842 > 10.244.0.4.53: Flags [P.], seq 1:51, ack 1, win 502, options [nop,nop,TS val 3847823347 ecr 2649092162], length 50 54188 A? greeting.default.cluster.local. (48)
08:55:26.471884 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37842: Flags [.], ack 51, win 509, options [nop,nop,TS val 2649092163 ecr 3847823347], length 0
08:55:26.472050 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37842: Flags [P.], seq 1:144, ack 51, win 509, options [nop,nop,TS val 2649092163 ecr 3847823347], length 143 54188 NXDomain*- 0/1/0 (141)
08:55:26.472074 eth0  Out IP 10.244.1.21.37842 > 10.244.0.4.53: Flags [.], ack 144, win 501, options [nop,nop,TS val 3847823347 ecr 2649092163], length 0
08:55:26.472299 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35876: Flags [P.], seq 1:144, ack 51, win 512, options [nop,nop,TS val 2383005127 ecr 3186051550], length 143 54188 NXDomain*- 0/1/0 (141)
08:55:26.472318 lo    In  IP 10.244.1.21.35876 > 127.0.0.1.4140: Flags [.], ack 144, win 501, options [nop,nop,TS val 3186051555 ecr 2383005127], length 0
08:55:26.472453 lo    In  IP 10.244.1.21.35876 > 127.0.0.1.4140: Flags [F.], seq 50, ack 144, win 501, options [nop,nop,TS val 3186051555 ecr 2383005127], length 0
08:55:26.472508 nsm-linker-5ee4 Out IP 172.16.1.2.53 > 172.16.1.3.45795: 54188 NXDomain*- 0/1/0 (141)
08:55:26.472563 eth0  Out IP 10.244.1.21.37842 > 10.244.0.4.53: Flags [F.], seq 51, ack 144, win 501, options [nop,nop,TS val 3847823348 ecr 2649092163], length 0
08:55:26.472733 eth0  In  IP 10.244.0.4.53 > 10.244.1.21.37842: Flags [F.], seq 144, ack 52, win 509, options [nop,nop,TS val 2649092164 ecr 3847823348], length 0
08:55:26.472752 eth0  Out IP 10.244.1.21.37842 > 10.244.0.4.53: Flags [.], ack 145, win 501, options [nop,nop,TS val 3847823348 ecr 2649092164], length 0
08:55:26.472855 lo    In  IP 10.96.0.10.53 > 10.244.1.21.35876: Flags [F.], seq 144, ack 52, win 512, options [nop,nop,TS val 2383005127 ecr 3186051555], length 0
08:55:26.472879 lo    In  IP 10.244.1.21.35876 > 127.0.0.1.4140: Flags [.], ack 145, win 501, options [nop,nop,TS val 3186051555 ecr 2383005127], length 0
08:55:26.474740 nsm-linker-5ee4 In  IP 172.16.1.3.41684 > 172.16.1.2.9080: Flags [S], seq 657000449, win 64400, options [mss 1400,sackOK,TS val 3084281421 ecr 0,nop,wscale 7], length 0
08:55:26.474804 nsm-linker-5ee4 Out IP 172.16.1.2.9080 > 172.16.1.3.41684: Flags [S.], seq 4038082371, ack 657000450, win 65236, options [mss 1400,sackOK,TS val 372751313 ecr 3084281421,nop,wscale 7], length 0
08:55:26.475259 nsm-linker-5ee4 In  IP 172.16.1.3.41684 > 172.16.1.2.9080: Flags [.], ack 1, win 504, options [nop,nop,TS val 3084281421 ecr 372751313], length 0
08:55:26.476398 nsm-linker-5ee4 In  IP 172.16.1.3.41684 > 172.16.1.2.9080: Flags [P.], seq 1:86, ack 1, win 504, options [nop,nop,TS val 3084281422 ecr 372751313], length 85
08:55:26.476437 nsm-linker-5ee4 Out IP 172.16.1.2.9080 > 172.16.1.3.41684: Flags [.], ack 86, win 509, options [nop,nop,TS val 372751315 ecr 3084281422], length 0
08:55:26.477292 nsm-linker-5ee4 Out IP 172.16.1.2.9080 > 172.16.1.3.41684: Flags [R.], seq 1, ack 86, win 509, options [nop,nop,TS val 372751316 ecr 3084281422], length 0


temp 
# Generated by iptables-save v1.8.8 on Tue Dec 20 09:38:37 2022
*nat
:PREROUTING ACCEPT [7720:357792]
:INPUT ACCEPT [7728:358272]
:OUTPUT ACCEPT [5:300]
:POSTROUTING ACCEPT [0:0]
:NSM_POST - [0:0]
:PROXY_INIT_OUTPUT - [0:0]
:PROXY_INIT_REDIRECT - [0:0]
-A PREROUTING -d 10.96.0.10/32 -j RETURN
-A PREROUTING -m comment --comment "proxy-init/install-proxy-init-prerouting/1671521120" -j PROXY_INIT_REDIRECT
-A INPUT -p tcp -j LOG
-A OUTPUT -d 10.96.0.10/32 -j RETURN
-A OUTPUT -m comment --comment "proxy-init/install-proxy-init-output/1671521120" -j PROXY_INIT_OUTPUT
-A POSTROUTING -j NSM_POST
-A NSM_POST -d 172.16.1.3/32 -j RETURN
-A NSM_POST -j SNAT --to-source 10.244.1.15
-A PROXY_INIT_OUTPUT -m owner --uid-owner 2102 -m comment --comment "proxy-init/ignore-proxy-user-id/1671521120" -j RETURN
-A PROXY_INIT_OUTPUT -o lo -m comment --comment "proxy-init/ignore-loopback/1671521120" -j RETURN
-A PROXY_INIT_OUTPUT -p tcp -m multiport --dports 4567,4568 -m comment --comment "proxy-init/ignore-port-4567,4568/1671521120" -j RETURN
-A PROXY_INIT_OUTPUT -p tcp -m comment --comment "proxy-init/redirect-all-outgoing-to-proxy-port/1671521120" -j REDIRECT --to-ports 4140
-A PROXY_INIT_REDIRECT -p tcp -m multiport --dports 4190,4191,4567,4568 -m comment --comment "proxy-init/ignore-port-4190,4191,4567,4568/1671521120" -j RETURN
-A PROXY_INIT_REDIRECT -p tcp -m comment --comment "proxy-init/redirect-all-incoming-to-proxy-port/1671521120" -j REDIRECT --to-ports 4143
COMMIT
# Completed on Tue Dec 20 09:38:37 2022
